<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>ã‚·ãƒ•ãƒˆç™»éŒ²ãƒ»ç®¡ç†ãƒšãƒ¼ã‚¸</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body { font-family: sans-serif; padding: 20px; background: #f9f9f9; }
      h2, h3 { border-bottom: 2px solid #4CAF50; padding-bottom: 5px; }
      input, select, button {
        font-size: 16px;
        margin-bottom: 10px;
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
      }
      button {
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s;
      }
      button:hover { background: #45a049; }
      button:disabled { background: #ccc; }
      label { display: block; margin-bottom: 5px; font-weight: bold; }
      .time-inputs { display: flex; align-items: center; gap: 10px; }
      .time-inputs input { width: calc(50% - 15px); }
      #status {
        margin-top: 15px;
        padding: 10px;
        border-radius: 4px;
        display: none;
      }
      .success { background-color: #d4edda; color: #155724; }
      .error { background-color: #f8d7da; color: #721c24; }
      table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
      th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
      th { background: #eee; }
    </style>
  </head>
  <body>
    <h2>ã‚·ãƒ•ãƒˆç™»éŒ²</h2>
    <form id="shiftForm">
      <label for="name">åå‰</label>
      <input type="text" id="name" name="name" placeholder="åå‰ã‚’å…¥åŠ›" required>
      
      <label for="role">ä»•äº‹</label>
      <select id="role" name="role" required>
        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
        <option value="ã‚¹ã‚¤ã‚«ã‚ã‚Š">ã‚¹ã‚¤ã‚«ã‚ã‚Š</option>
        <option value="ã®ã¿ã‚‚ã®">ã®ã¿ã‚‚ã®</option>
        <option value="ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒœãƒ¼ãƒ«">ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒœãƒ¼ãƒ«</option>
        <option value="ã—ã‚ƒã¦ã">ã—ã‚ƒã¦ã</option>
        <option value="ã‚ãªã’">ã‚ãªã’</option>
        <option value="ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³">ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³</option>
        <option value="ã‚ãŸãŒã—">ã‚ãŸãŒã—</option>
      </select>
      
      <label>æ™‚é–“</label>
      <div class="time-inputs">
        <input type="time" id="start" name="start" required>
        <span>ï½</span>
        <input type="time" id="end" name="end" required>
      </div>
      
      <label for="color">ã‚«ãƒ¼ãƒ‰ã®è‰²</label>
      <select id="color" name="color" required>
        <option value="">è‰²ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
        <option value="#ff9999">ğŸ”´ ã‚ã‹</option>
        <option value="#99ccff">ï¿½ ã‚ãŠ</option>
        <option value="#ffff99">ğŸŸ¡ ãã„ã‚</option>
        <option value="#99ff99">ğŸŸ¢ ã¿ã©ã‚Š</option>
      </select>

      <label for="number">å—ä»˜ç•ªå·</label>
      <input type="text" id="number" name="number" placeholder="åŠè§’æ•°å­—ã§å…¥åŠ›" required>
      
      <button type="submit">âœ… ç™»éŒ²</button>
    </form>
    <div id="status"></div>

    <h3>ç¾åœ¨ã®ç™»éŒ²çŠ¶æ³</h3>
    <table id="shiftTable">
        <thead>
            <tr>
                <th>åå‰</th>
                <th>ä»•äº‹</th>
                <th>æ™‚é–“</th>
            </tr>
        </thead>
        <tbody>
            <tr><td colspan="3">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
        </tbody>
    </table>

    <script>
      const form = document.getElementById('shiftForm');
      const submitButton = form.querySelector('button[type="submit"]');
      const statusDiv = document.getElementById('status');
      const tableBody = document.querySelector("#shiftTable tbody");

      // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®å‡¦ç†
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        submitButton.disabled = true;
        submitButton.textContent = 'ç™»éŒ²ä¸­...';
        statusDiv.style.display = 'none';

        // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦å–å¾—
        const formData = {};
        new FormData(form).forEach((value, key) => {
          formData[key] = value;
        });

        // Google Apps Scriptã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰é–¢æ•°ã‚’å‘¼ã³å‡ºã™
        google.script.run
          .withSuccessHandler(onSuccess)
          .withFailureHandler(onFailure)
          .appendData(formData);
      });

      // ç™»éŒ²æˆåŠŸæ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°
      function onSuccess(response) {
        statusDiv.className = 'success';
        statusDiv.textContent = 'âœ… ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼';
        statusDiv.style.display = 'block';
        form.reset();
        submitButton.disabled = false;
        submitButton.textContent = 'âœ… ç™»éŒ²';
        loadShifts(); // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å†èª­ã¿è¾¼ã¿
      }

      // ç™»éŒ²å¤±æ•—æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°
      function onFailure(error) {
        statusDiv.className = 'error';
        statusDiv.textContent = 'âŒ ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message;
        statusDiv.style.display = 'block';
        submitButton.disabled = false;
        submitButton.textContent = 'âœ… ç™»éŒ²';
      }

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚·ãƒ•ãƒˆä¸€è¦§ã‚’èª­ã¿è¾¼ã‚€
      function loadShifts() {
        google.script.run
          .withSuccessHandler(displayShifts)
          .withFailureHandler(onFailure)
          .getShifts();
      }

      // ã‚·ãƒ•ãƒˆä¸€è¦§ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡¨ç¤ºã™ã‚‹é–¢æ•°
      function displayShifts(shifts) {
        tableBody.innerHTML = '';
        if (shifts.length === 0) {
          tableBody.innerHTML = '<tr><td colspan="3">ç™»éŒ²ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</td></tr>';
          return;
        }
        shifts.forEach(shift => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${shift.åå‰}</td>
            <td>${shift.ä»•äº‹}</td>
            <td>${shift.é–‹å§‹æ™‚é–“} ï½ ${shift.çµ‚äº†æ™‚é–“}</td>
          `;
          tableBody.appendChild(row);
        });
      }

      // ãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰åˆå›èª­ã¿è¾¼ã¿ã‚’å®Ÿè¡Œ
      document.addEventListener('DOMContentLoaded', loadShifts);
    </script>
  </body>
</html>
ï¿½